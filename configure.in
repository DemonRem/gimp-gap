dnl Process this file with autoconf to produce a configure script.

AC_PREREQ(2.52)
AC_INIT(configure.in)
AM_CONFIG_HEADER(config.h)

GAP_MAJOR_VERSION=1
GAP_MINOR_VERSION=3
GAP_MICRO_VERSION=16
GAP_VERSION=$GAP_MAJOR_VERSION.$GAP_MINOR_VERSION.$GAP_MICRO_VERSION

VERSION=$GAP_VERSION

GETTEXT_PACKAGE=gimp20-gap
AC_SUBST(GETTEXT_PACKAGE)
AC_DEFINE_UNQUOTED(GETTEXT_PACKAGE, "$GETTEXT_PACKAGE",
                   [The gettext translation domain.])

AM_INIT_AUTOMAKE(gimp-gap, $VERSION)

AC_PROG_CC
AC_ISC_POSIX
AM_PROG_CC_STDC
AC_HEADER_STDC

ACLOCAL="$ACLOCAL $ACLOCAL_FLAGS"

AC_CHECK_HEADERS(unistd.h)
AC_CHECK_FUNCS(bind_textdomain_codeset)

AM_MAINTAINER_MODE

AM_PATH_GIMP_2_0(1.3.17, , AC_MSG_ERROR(Cannot find GIMP-2.0.))

dnl Test for libmpeg
AC_ARG_ENABLE(mpeg,
              [  --disable-mpeg          don't build MPEG decoder plug-in])
  if test "x$enable_mpeg" != "xno"; then
  if test -z "$LIBMPEG"; then
    AC_CHECK_LIB(mpeg, GetMPEGFrame,
      [AC_CHECK_HEADER(mpeg.h,
	MPEG='mpeg'$EXEEXT; LIBMPEG='-lmpeg'; GAP_DECODE_MPEG='gap_decode_mpeg',
	[AC_MSG_WARN(*** MPEG plug-in will not be built (MPEG header file not found) ***)])],
      [AC_MSG_WARN(*** MPEG plug-in will not be built (MPEG library not found) ***)])
  fi
  fi

AC_SUBST(GAP_DECODE_MPEG)


ALL_LINGUAS="ca cs da de el en_GB es fi fr ga gl hr hu it ja ko lt ml nl nn no pl pt pt_BR ro ru sk sl sv tr uk zh_CN zh_TW"
AM_GLIB_GNU_GETTEXT

LOCALEDIR='${prefix}/${DATADIRNAME}/locale'

dnl Use -Wall if we have gcc.
changequote(,)dnl
if test "x$GCC" = "xyes"; then
  case " $CFLAGS " in
  *[\ \	]-Wall[\ \	]*) ;;
  *) CFLAGS="$CFLAGS -Wall" ;;
  esac
fi
changequote([,])dnl

CPPFLAGS="$CPPFLAGS -DG_DISABLE_DEPRECATED -DGDK_DISABLE_DEPRECATED"

AC_SUBST(GAP_MAJOR_VERSION)
AC_SUBST(GAP_MINOR_VERSION)
AC_SUBST(GAP_VERSION)
	
AC_SUBST(LOCALEDIR)

AC_OUTPUT([
Makefile
images/Makefile
gap/Makefile
po/Makefile.in
])
